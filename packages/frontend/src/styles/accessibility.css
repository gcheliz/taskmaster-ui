/* Accessibility Utilities - TaskMaster UI */
/* Enhanced accessibility features for WCAG 2.1 AA compliance */

/* === FOCUS MANAGEMENT === */

/* Enhanced focus outlines for better visibility */
*:focus,
*:focus-visible {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
  z-index: 1;
}

/* Focus within containers */
.focus-within-ring:focus-within {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
}

/* High contrast mode focus enhancements */
@media (prefers-contrast: high) {
  *:focus,
  *:focus-visible {
    outline-width: 4px;
    outline-offset: 3px;
  }
}

/* === SCREEN READER UTILITIES === */

/* Screen reader only content */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Make sr-only content visible when focused */
.sr-only:focus {
  position: static;
  width: auto;
  height: auto;
  padding: inherit;
  margin: inherit;
  overflow: visible;
  clip: auto;
  white-space: normal;
  border: inherit;
}

/* === KEYBOARD NAVIGATION === */

/* Visual indicator for keyboard users */
.keyboard-user *:focus {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
}

/* Hide focus outline for mouse users */
.mouse-user *:focus {
  outline: none;
}

/* Restore focus for keyboard users after mouse interaction */
.mouse-user *:focus:focus-visible {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
}

/* === SKIP NAVIGATION === */

/* Multiple skip links for complex layouts */
.skip-nav {
  position: absolute;
  top: -100px;
  left: var(--spacing-2);
  z-index: var(--z-index-modal);
}

.skip-nav:focus {
  top: var(--spacing-2);
}

.skip-nav a {
  display: inline-block;
  background: var(--color-primary);
  color: white;
  padding: var(--spacing-3) var(--spacing-5);
  text-decoration: none;
  border-radius: var(--border-radius-md);
  font-weight: var(--font-weight-semibold);
  font-size: var(--font-size-base);
  border: 2px solid transparent;
  margin-right: var(--spacing-2);
  transition: var(--transition-all);
}

.skip-nav a:focus {
  outline: none;
  border-color: white;
  box-shadow: var(--shadow-lg);
}

.skip-nav a:hover {
  background: var(--color-primary-hover);
}

/* === MODAL AND DIALOG ACCESSIBILITY === */

/* Modal backdrop */
.modal-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--modal-backdrop-color);
  z-index: var(--z-index-modal-backdrop);
}

/* Focus trap for modals */
.focus-trap-boundary {
  position: relative;
}

.focus-trap-boundary::before,
.focus-trap-boundary::after {
  content: '';
  position: absolute;
  width: 1px;
  height: 1px;
  opacity: 0;
  pointer-events: none;
}

/* === REDUCED MOTION === */

@media (prefers-reduced-motion: reduce) {
  /* Remove animations for users who prefer reduced motion */
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
  
  /* Keep focus transitions for accessibility */
  *:focus,
  *:focus-visible {
    transition: outline 0.15s ease !important;
  }
}

/* === CONTRAST ADJUSTMENTS === */

/* High contrast mode adjustments */
@media (prefers-contrast: high) {
  /* Increase border contrast */
  .card,
  .button,
  input,
  select,
  textarea {
    border-width: 2px;
  }
  
  /* Ensure button hover states are visible */
  .button:hover:not(:disabled) {
    border-width: 3px;
  }
  
  /* Enhance focus indicators */
  *:focus,
  *:focus-visible {
    outline-width: 4px;
    box-shadow: 0 0 0 2px var(--color-surface), 0 0 0 6px var(--focus-ring-color);
  }
}

/* === DARK MODE ACCESSIBILITY === */

[data-theme="dark"] {
  /* Enhance focus visibility in dark mode */
  --focus-ring-color: var(--primary-400);
  
  /* Adjust shadows for better visibility */
  --shadow-focus: 0 0 0 3px rgba(96, 165, 250, 0.7);
  --shadow-focus-error: 0 0 0 3px rgba(248, 113, 113, 0.7);
  --shadow-focus-success: 0 0 0 3px rgba(74, 222, 128, 0.7);
  --shadow-focus-warning: 0 0 0 3px rgba(251, 191, 36, 0.7);
}

/* === INTERACTIVE ELEMENT ENHANCEMENTS === */

/* Ensure all interactive elements are keyboard accessible */
[role="button"]:not(button),
[role="link"]:not(a),
[role="tab"],
[role="menuitem"],
[role="option"] {
  cursor: pointer;
  outline: none;
}

[role="button"]:not(button):focus,
[role="link"]:not(a):focus,
[role="tab"]:focus,
[role="menuitem"]:focus,
[role="option"]:focus {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
}

/* Ensure proper spacing for touch targets */
.touch-target {
  min-height: 44px;
  min-width: 44px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/* === STATUS AND ALERT ENHANCEMENTS === */

/* Live region for dynamic content */
.live-region {
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

/* Status messages that should be announced */
.status-message {
  padding: var(--spacing-3) var(--spacing-4);
  border-radius: var(--border-radius-md);
  font-weight: var(--font-weight-medium);
}

.status-message.success {
  background-color: var(--color-success-bg);
  color: var(--color-success);
  border: 1px solid var(--success-200);
}

.status-message.error {
  background-color: var(--color-error-bg);
  color: var(--color-error);
  border: 1px solid var(--error-200);
}

.status-message.warning {
  background-color: var(--color-warning-bg);
  color: var(--color-warning);
  border: 1px solid var(--warning-200);
}

/* === COLOR CONTRAST UTILITIES === */

/* Text utilities with guaranteed contrast ratios */
.text-high-contrast {
  color: var(--color-text-primary);
  font-weight: var(--font-weight-semibold);
}

.text-medium-contrast {
  color: var(--color-text-secondary);
  font-weight: var(--font-weight-medium);
}

/* Background utilities with proper contrast */
.bg-high-contrast {
  background-color: var(--color-text-primary);
  color: var(--color-surface);
}

.bg-medium-contrast {
  background-color: var(--color-surface-secondary);
  color: var(--color-text-primary);
}

/* === PRINT ACCESSIBILITY === */

@media print {
  /* Ensure focus indicators are visible in print */
  *:focus {
    outline: 2px solid #000 !important;
  }
  
  /* Show URLs for links */
  a[href^="http"]:after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
    color: #666;
  }
  
  /* Hide non-essential interactive elements */
  .skip-nav,
  .modal-backdrop,
  .focus-trap-boundary::before,
  .focus-trap-boundary::after {
    display: none !important;
  }
}